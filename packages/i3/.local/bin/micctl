#!/bin/bash

# Compose and send notification using the dunstify.
function notify() {

    msgId='1003'
    dunstify="dunstify -r ${msgId} -a micctl"

    amixer get Capture | egrep -o '\[on\]' >/dev/null 2>&1

    [ $? -eq 0 ] &&
        (emoji="ðŸŽ¤"; msg="Mic unmuted."; ${dunstify} "${emoji} ${msg}") ||
        (emoji="ðŸ™Š"; msg="Mic muted.";   ${dunstify} "${emoji} ${msg}")

    
}

case $1 in
toggle)
    amixer -q -D pulse sset Capture toggle &&
        pkill -RTMIN+1 i3blocks && notify
esac
